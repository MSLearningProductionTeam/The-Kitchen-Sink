<html>
  <head>
    <style>
    /*global styles*/
    .correct_color{background-color: green !important;}
    .incorrect_color{background-color: rgb(251, 51, 51) !important;}
    .hidden{display:none !important;}
    .flexibleDisplay{display: flex;}
    .fillContentArea{width: 100%}
    .subText{font-size: 12px; margin: 5px 0 5px 0;}
    .loadingImg{width: 20px;}
    body{background:#E6E6E6!important;}

    #intakeFormContentContainer{position: relative; left: 50%; transform: translateX(-50%); width: 900px; background: white; padding-bottom: 1px;}
      #intakeFormContentContainer p {margin:10px; font-family: "SegoeUI Light", "Segoe UI","Helvetica Neue",Helvetica,Arial,sans-serif; font-size: 17px;}
      .intakeFormBanner{background:#243b56; padding:5px; color:white; font-size: 18px; font-family: "SegoeUI Light", "Segoe UI","Helvetica Neue",Helvetica,Arial,sans-serif; height:36px;}
      #formselectionContainer{margin:15px;}
        #formSelectionItem{background:#e7ffe7; width: 225px; margin-top:10px; margin-left: 10px;}
          #formSelectionItem .typeOfForm{padding:5px; cursor:pointer;}
          #formSelectionItem .typeOfForm:hover{background:rgb(172, 177, 170);}
          #formSelectionItem .typeOfForm.selected{background:rgb(172, 177, 170); color:white;}
      #intakeFormContainer{position: relative; /*left:-1000px;*/ width: 864px; left: 50%; transform: translate3d(-50%,0,0); margin-top:10px; margin-bottom:10px;}
        .intakeFormSection{border: 1px solid rgb(228, 233, 246); display: flex; font-size:17px; margin:-1px;}
          .formSectionTitle{padding:10px; width: 185px; min-width: 185px; border-right: 1px solid rgb(228, 233, 246); text-align: right; font-family: "SegoeUI Light", "Segoe UI","Helvetica Neue",Helvetica,Arial,sans-serif;}
            .formSectionTitle ul li{list-style-type: none; font-size:12px; }
          .formSectionInput{margin:10px; flex-grow: 1; align-self: center;}
            #ownerInput{width: 295px;}
            #coownerInput{width: 295px;}
            #attachmentInput{color:black !important;}
            .formSectionInput a{color:#0072c6 !important;}
          .seeExampleButton{background:rgb(237, 235, 235); border:1px solid rgb(213, 217, 211);  width: 20px; height: 20px; margin: 10px 10px 10px 5px;}
          .seeExampleButton:hover{background: rgb(109, 112, 109);}
          .seeExampleButton.selected{background: rgb(109, 112, 109);}
          .seeExampleImage{margin:0 0 0 10px;}
        #buttonContainer{display:flex; margin:10px 0 0 0;}
          .inputBtn{cursor: pointer; background:#243b56; padding:10px; width:200px; margin-right:10px; margin:0px auto; color:white; font-size: 20px; text-align: center;}
    </style>
    <script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
    <script>
    window.onload = function(){
      //globals
      //absolute url path to sp list
      var siteUrl;
      //timer for the people search function
      var peoplePickerTimer;
      //object containing all attachment data
      var attachedFileData;
      //file reader
      var reader;


      init();

      function init(){
        //initalize variables
        attachedFileData = {};
        //define the siteUrl variable if the _spPageContextInfo object exists
        if(typeof _spPageContextInfo !== 'undefined'){siteUrl = _spPageContextInfo.webAbsoluteUrl;}
        //set greeting name
        setGreetingName();
        //attach the events to the controls
        attachEvents();
      }

      //*****to do****
      //checks that all inputs that are going to be submited are valid
      function validateForm(){
        //check that all required inputs are filled in and valid
        $("#intakeFormContainer .intakeFormSection:visible .requiredInput").each(function(){
          //if the input is blank or null or is invalid mark the input invalid and turn it red
          if(($(this).val() == "" || $(this).val() == null)){
            $(this).addClass("invalid");
            $(this).addClass("incorrect_color");
          }
          //if the input is not blank but has already been determined incorrect set it as invalid
          //EX: the owner input returning a n incorrect user
          else if($(this).hasClass("#incorrect_color")){
            $(this).addClass("invalid");
          }
          //otherwise validate the input
          else{
            $(this).addClass("valid");
            $(this).removeClass("incorrect_color");
          }
        });
        //check all optionl inputs
        $("#intakeFormContainer .intakeFormSection:visible .optionalInput").each(function(){
          //if the input is not blank and the value is not null  and the value has not been marked as inccorect
          // or if the value is blank mark the input as valid
          if(($(this).val() !== "" && $(this).val() !== null && $(this).hasClass("#incorrect_color")) || ($(this).val() == "") ){
            $(this).addClass("valid");
            $(this).removeClass("incorrect_color");
          }
          //otherwise mark the input as invalid and make it red
          else{
            $(this).addClass("invalid");
            $(this).addClass("incorrect_color");
          }
        });

        //check the attachmentInput
        //if the input is blank, or the file reader is done or empty consider it valid
        if(($("#attachmentInput").val() == "") || (reader.readyState == 2 || reader.readyState == 0)){
          $("#attachmentInput").addClass("valid");
        }
        //if the file reader is in progress mark the input as invalid
        else if(reader.readyState == 1){
          $("#attachmentInput").addClass("invalid");
        }

        //if any of the visible inputs is invalid or not marked as valid throw an error
        if($("#intakeFormContainer .intakeFormSection:visible .formInput").hasClass("invalid") || !$("#intakeFormContainer .intakeFormSection:visible .formInput").hasClass("valid")){
          alert("plase fill in all fields with the correct information");
          throw new Error("Form fields were not filled out correctly");
        }

      }


      //the object that is used to make the new sp list item
      function gatherFormData(){
        //object containing the data to send to sharepoint
        var itemData = {
          '__metadata': {'type': "SP.Data.New_x0020_Intake_x0020_Form_x0020_TestListItem"},
        };
        //add all visible and valid input values to the object
        $("#intakeFormContainer .intakeFormSection:visible .formInput.valid").each(function(){
          //ignore the attachements input for now and do not add it as there is no sharepoint list column to accept it
          if($(this).attr("data-property")!== "Attachments"){
            itemData[$(this).attr("data-property")] = $(this).val();
          }
        });

        return itemData;
      }


        //creates a new SP list item
        //itemProperties => an object containing all the properties of the new list item you want to create EX. Title, description, etc.
        //attachment => the object containing all attachment data, if there is any
        function createListItem(itemProperties,attachment){
          //before the request make sure you obtain a new form digest value and the list type
          $.when(
            getFormDigest(),
            getListType()
          ).then(function(data){
            $.ajax({
                url: siteUrl + "/_api/web/lists/getbytitle('New Intake Form Test')/items",
                type: "POST",
                contentType: "application/json;odata=verbose",
                data: JSON.stringify(itemProperties),
                headers: {
                    "Accept": "application/json;odata=verbose",
                    "X-RequestDigest": data[0].d.GetContextWebInformation.FormDigestValue
                },
                success: function (successData) {
                  //check if the attachment object is empty
                  if(!jQuery.isEmptyObject(attachment)){
                    var itemId = successData.d.Id;
                    $.ajax({
                        url: siteUrl + "/_api/web/lists/getbytitle('New Intake Form Test')/items("+itemId+")/AttachmentFiles/add(FileName='"+attachment.fileName+"')",
                        type: "POST",
                        contentType: "application/json;odata=verbose",
                        data: attachment.fileString,
                        headers: {
                            "Accept": "application/json;odata=verbose",
                            "X-RequestDigest":  data[0].d.GetContextWebInformation.FormDigestValue
                        },
                        success: function (data) {
                          console.log("Created new list item ");
                          alert("New list item created");
                        },
                        error: function (data) {
                          console.log(data);
                            throw new Error("There was an error in attaching the file to the sharepoint list");

                        }
                    });
                  }
                  //if there is no attachment alert that a new item has been created
                  else{
                    console.log("Created new list item ");
                    alert("New list item created");
                  }
                },
                error: function (data) {
                  console.log(data);
                  throw new Error("There was an error in writing to the sharepoint list");
                }
            });
          });
        }

        //get a new digest value for the Form
        //the digest value prevents the same form submission from being applied multiple times
        function getFormDigest() {
            return $.ajax({
                url: siteUrl + "/_api/contextinfo",
                method: "POST",
                headers: { "Accept": "application/json; odata=verbose" },
                success: function(data){
                  console.log("Obtained new form digest " +data.d.GetContextWebInformation.FormDigestValue);
                }
            });
        }
        //gets the SP list type
        //used when making an api request
        function getListType(){
          return $.ajax({
            url: siteUrl + "/_api/web/lists/getbytitle('New Intake Form Test')/items",
            Type:'GET',
            headers: {
              accept: "application/json;odata=verbose"
            },
            success: function(data){
              console.log("Obtained list type");
            }
          });
        }


        //checks sharepoint for a valid user
        // user => the user to query for
        // inputField => the input box the user is typing into
        function searchForUser(user,inputField){
          $.when(
            getFormDigest()
          ).then(function(data){
          $.ajax({
              url: siteUrl + "/_api/SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.clientPeoplePickerSearchUser",
              type: "POST",
              data:JSON.stringify({
                  'queryParams':{
                      '__metadata':{
                          'type':'SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters'
                      },
                      'AllowEmailAddresses':true,
                      'AllowMultipleEntities':false,
                      'AllUrlZones':false,
                      'MaximumEntitySuggestions':4,
                      'Required': true,
                      'PrincipalSource':15,
                      'PrincipalType': 1,
                      'QueryString': user
                  }
              }),
              contentType: "application/json;odata=verbose",
              headers: {
                  "Accept": "application/json;odata=verbose",
                  "X-RequestDigest": data.d.GetContextWebInformation.FormDigestValue
              },
              success: function (data) {
                var results = JSON.parse(data.d.ClientPeoplePickerSearchUser);
                //if the object is empty consider the input invalid
                //if the object returns more then 1 result consider the input invalid
                if(results.length <= 0 || results.length > 1){
                  $("#"+inputField).removeClass('valid');
                  $("#"+inputField).removeClass('correct_color');
                  $("#"+inputField).addClass('invalid');
                  $("#"+inputField).addClass('incorrect_color');
                }
                else{
                  //if the person is considered valid mark it as valid and update the
                  //text displayed to the returned display text
                  $("#"+inputField).removeClass('invalid');
                  $("#"+inputField).removeClass('incorrect_color');
                  $("#"+inputField).val(results[0].DisplayText);
                  $("#"+inputField).addClass('valid');
                  $("#"+inputField).addClass('correct_color');
                }
              },
              error: function (data) {
                console.log(data);
                 throw new Error("There was an issue with querying for the specified user");
              }
            });
          });
        }

        //display the correct input fields based on which form is selected
        // form => the class of the form you want to display
        // footer => value of the new footer to display
        function swapFormContent(form,footer){
          //show the form container since it starts hidden
          $("#intakeFormContainer").removeClass("hidden");
          //hide all forms
          $(".intakeFormSection").addClass("hidden");
          //show the selected form
          $("."+form).removeClass("hidden");
          //change the footer value
          $("#intakeFormFooter").html(footer);
        }

        //sets the greeting at the top of the form to be the current users first name
        function setGreetingName(){
          $.ajax({
              url: siteUrl + "/_api/web/currentUser",
              Type:'GET',
              headers: {
                accept: "application/json;odata=verbose"
              }
            }).done(function(data){
                $("#formGreeting").html("Hi, "+ data.d.Title.substring(0,data.d.Title.indexOf(" ")));
            });
        }

        //reads the file provided as a url data url stringify
        //file => the file to read, needs to be a blob or file object
        //callback => callback function to execute once the read operation has completed
        function readFile(file,callback){
          if(typeof file !== "undefined"){
            reader = new FileReader();
            reader.onload = callback;
            reader.readAsBinaryString(file);
          }
        }


        //attachs all necessary event handlers
        function attachEvents(){
          //event handler for the add list item button
          //creaes a new list item based on form information
          $("#addBtn").on("click",function(){
            validateForm();
            var itemData = gatherFormData();
            createListItem(itemData,attachedFileData);
          });

          $(".formInput:not([type='file'])").on('change',function(){
            $(this).removeClass("invalid");
          });

          //event handler for the people picker input box
          //check when the user has stopped typing and runs a people serach
          $("#ownerInput, #coownerInput").on("keyup",function(){
            //the value in the input box after the user has stopped typing
            var typedVal = $(this).val();
            var inputId = $(this).attr("id");

            if(typedVal !== ""){
              //if the user stops typing for 1 second check if the value they have
              //input is a valid user
              clearTimeout(peoplePickerTimer);
              peoplePickerTimer = setTimeout(function(){
                  searchForUser(typedVal,inputId);
              },750);
            }
            else{
              $(this).removeClass("invalid");
              $(this).removeClass("incorrect_color");
            }
          });
          //clears the people search timer when the user resumes typing
          $("#ownerInput, #coownerInput").on("keydown",function(){
            //stop showing the loading icon
            clearTimeout(peoplePickerTimer);
          });

          //event for the file picker, when a file is picked and read validate the input
          //*****to do****
          //sanitize files so that only certain files can be used
          $("#attachmentInput").on("change",function(ele){
            //clear the attachedFileData object
            delete attachedFileData.fileString;
            delete attachedFileData.fileName;
            //set a timer so that if the file being read is taking longer then 5 seconds a loading image is shown
            var loadingTimer = setTimeout(function(){
                $(ele.target).next().removeClass("hidden");
            },5000);

            readFile(this.files[0],function(e){
              //remove the timer for the loading icon and make sure the image is hidden
              clearTimeout(loadingTimer);
              $(ele.target).next().addClass("hidden");
              //once the file is read build out the fild data object
              attachedFileData.fileString = this.result;
              attachedFileData.fileName = ele.target.files[0].name;
              $("#attachmentLoading").addClass("hidden");
              console.log(this.result);
            });
          });


          //shows and hides the example image
          $(".seeExampleButton").on("click", function(){
            if($(this).next().hasClass("hidden")){
              $(this).next().removeClass("hidden");
            }
            else{
                $(this).next().addClass("hidden");
            }
          });

          //swaps the form content on the page
          $('#formSelectionItem .typeOfForm').on("click",function(){
            $('.typeOfForm').removeClass("selected");
            $(this).addClass("selected");
            var selectedForm = $(this).attr("data-form");
            var footer = $(this).attr("data-footerVal");
            swapFormContent(selectedForm,footer);

          });


          //event for the display list items button, displays all list items
          //used just for testing purposes, will be removed later
          /*$("#displayContainer #displayBtn").on("click",function(){
            $.ajax({
              url: siteUrl + "/_api/web/lists/getbytitle('New Intake Form Test')/items",
              Type:'GET',
              headers: {
                accept: "application/json;odata=verbose"
              }
            }).done(function(data){
              var allListItems = [];
              data.d.results.forEach(function(val,i){
                allListItems.push("<li>"+val.Title+"</li>");
                console.log(data);
              });
              console.log(allListItems);
              allListItems.forEach(function(val,i){
                $("#listItemContainer ul").html(val);
              });
            });
          });*/

          //event handler for the form selection
          //changes which form is visible and animates the form in and out
          //on hold for now until new swapping functionality is completed
        /*  $('#formSelectionItem .typeOfForm').on("click",function(){
            $('.typeOfForm').removeClass("selected");
            $(this).addClass("selected");
            var selectedForm = $(this).attr("data-form");
            $("#intakeFormContainer").animate({
              left:"-1000px"
            },500,function(){
              console.log("Animated off screen");
              $("#intakeFormContainer").addClass("hidden");
              $("#intakeFormContainer").removeClass("selectedForm");
            }).promise().done(function(){
              $("#"+selectedForm).removeClass("hidden");
              $("#"+selectedForm).addClass("selectedForm");
              $("#"+selectedForm).animate({
                left:"50px"
              },500,function(){
                $("#"+selectedForm).animate({
                  left: "-10px"
                },400,function(){
                  $("#"+selectedForm).animate({
                    left: "0px"
                  },300,function(){
                    console.log("Animated on screen");
                  });
                });
              });
            });
          });*/

        }
    }
    </script>
  </head>
    <body>
      <div id="intakeFormContentContainer">
        <div id="intakeFormHeader" class="intakeFormBanner">Virtual Help Desk   |  Windows Ready/Devices Group</div>
        <div id="formselectionContainer">
          <p id="formGreeting">Hi,</p>
          <p>What would you like assistance with today?</p>
          <div class="flexibleDisplay">
            <p>I would like to</p>
            <div id="formSelectionItem">
              <div class="typeOfForm" data-form="Form1" data-footerVal="New /Learning Publishing Request: Windows Devices Group - Publishing Request (add new content) ">add new content</div>
              <div class="typeOfForm" data-form="Form2" data-footerVal="New /Learning Publishing Request: Windows Devices Group - Publishing Request (update existing content) ">update existing content</div>
              <div class="typeOfForm" data-form="Form3" data-footerVal="New /Learning Publishing Request: Windows Devices Group - Publishing Request (remove content) ">remove content</div>
              <div class="typeOfForm" data-form="Form4" data-footerVal="New /Learning Publishing Request: Windows Devices Group - Publishing Request (request multiple items) ">request multiple items</div>
              <div class="typeOfForm" data-form="Form5" data-footerVal="New /Learning Publishing Request: Windows Devices Group - Publishing Request (do something not listed here) ">do something not listed here</div>
            </div>
          </div>
        </div>
        <div id="intakeFormFooter" class="intakeFormBanner"></div>
        <div id="intakeFormContainer" class="hidden">
          <div class="intakeFormSection Form1">
            <p>Use this form to add new content</p>
          </div>
          <div class="intakeFormSection Form2">
            <p>Use this form to update an asset.</p>
          </div>
          <div class="intakeFormSection Form3">
            <p>Use this form for a request to delete, hide, or remove content from Learning, page, or card.</p>
          </div>
          <div class="intakeFormSection Form4">
            <p>Use this form for requests that require multiple actions. (Note requests with more then 5 items require a BOM template.)</p>
          </div>
          <div class="intakeFormSection Form5">
            <p>Use this form for a request not listed as a choice, or you are not sure what type of request it is, or complex project.</p>
          </div>
          <div class="intakeFormSection Form1 Form2">
            <P>See example</p>
            <div class="seeExampleButton"></div>
            <img src="https://microsoft.sharepoint.com/teams/Infopedia_Team_Site/Projects%20Folder/Trey%20Test%20Stuff/FormResource.png" class="hidden seeExampleImage"/>
          </div>
          <div class="intakeFormSection  Form3">
            <P>See example</p>
            <div class="seeExampleButton"></div>
            <img src="https://microsoft.sharepoint.com/teams/Infopedia_Team_Site/Projects%20Folder/Trey%20Test%20Stuff/FormResource2.png" class="hidden seeExampleImage"/>
          </div>
          <div class="intakeFormSection Form4">
            <P>See example</p>
            <div class="seeExampleButton"></div>
            <img src="https://microsoft.sharepoint.com/teams/Infopedia_Team_Site/Projects%20Folder/Trey%20Test%20Stuff/FormResource3.png" class="hidden seeExampleImage"/>
          </div>
          <div class="intakeFormSection Form5">
            <P>See example</p>
            <div class="seeExampleButton"></div>
            <img src="https://microsoft.sharepoint.com/teams/Infopedia_Team_Site/Projects%20Folder/Trey%20Test%20Stuff/FormResource4.png" class="hidden seeExampleImage"/>
          </div>
          <div class="intakeFormSection Form1 Form2 Form3 Form4 Form5">
            <div class="formSectionTitle">Product Group*</div>
            <div class="formSectionInput">
              <select id="productGroupInput" class="requiredInput formInput" data-property="ProductGroup">
                <option disabled selected value> -- select an option -- </option>
                <option value="Windows">Windows</option>
                <option value="Devices">Devices</option>
              </select>
            </div>
          </div>
          <div class="intakeFormSection Form3">
            <div class="formSectionTitle">Doc ID or Page/Card URL*</div>
            <div class="formSectionInput">
              <input id="docIdInput" class="requiredInput formInput fillContentArea" data-property="DocumentID" type="text" autocomplete="off" placeholder=""></input>
              <div class="subText">
                Please give page URL or Doc ID of asset to be removed
              </div>
            </div>
          </div>
          <div class="intakeFormSection Form4">
            <div class="formSectionTitle">Request Overview*</div>
            <div class="formSectionInput">
              <textarea id="requestOverviewInput" class="requiredInput formInput fillContentArea" data-property="RequestOverview" type="text" autocomplete="off" placeholder="" rows="4" cols="50"></textarea>
              <div class="subText">
                Please provide a brief overview/summary of your request.(e.g. update page, with cards, featuring new items and tags)
              </div>
            </div>
          </div>
          <div class="intakeFormSection Form4">
            <div class="formSectionTitle">
              Request Details*
              <div>(Example)</div>
              <ul>
                <li>Item 1</li>
                <li>Title</li>
                <li>Description</li>
                <li>Confidentiality</li>
              </ul>
              <ul>
                <li>Item 2</li>
                <li>Title</li>
                <li>Description</li>
                <li>Confidentiality</li>
              </ul>
              <ul>
                <li>Item 3</li>
                <li>Title</li>
                <li>Description</li>
                <li>Confidentiality</li>
              </ul>
            </div>
            <div class="formSectionInput">
              <textarea id="requestDetailsInput" class="requiredInput formInput fillContentArea" data-property="RequestDetails" type="text" autocomplete="off" placeholder="" rows="20" cols="50"></textarea>
              <div class="subText">
                Please provide specific and granular details of your request.
              </div>
            </div>
          </div>
          <div class="intakeFormSection Form4">
            <div class="formSectionTitle">BOM Template</div>
              <div class="formSectionInput">
                <div class="subText">
                  If you have multiple items in your request, please download the appropriate BOMs below.
                </div>
                <a href="https://microsoft.sharepoint.com/sites/infopedia/pages/layouts/KCDoc.aspx?k=G02KC-1-10621&downloadnow=1">Asset BOM Template</a><br/>
                <a href="https://microsoft.sharepoint.com/sites/infopedia/pages/layouts/KCDoc.aspx?k=G02KC-1-10622&downloadnow=1">Card BOM Template</a>
                <div class="subText">
                  Fill it out, and attach to your request below.
                </div>
              </div>
            </div>
          <div class="intakeFormSection Form5">
            <div class="formSectionTitle">Details</div>
            <div class="formSectionInput">
              <textarea id="detailsInput" class="optionalInput formInput fillContentArea" data-property="Details" type="text" autocomplete="off" placeholder="" rows="4" cols="50"></textarea>
              <div class="subText">
                Please provide all required information or attach detailed instructions.
              </div>
            </div>
          </div>
          <div class="intakeFormSection Form1 Form2 Form4">
            <div class="formSectionTitle">Source File Location</div>
            <div class="formSectionInput">
              <input id="sourceFileLocationInput" class="optionalInput formInput fillContentArea" data-property="SourceFileLocation" type="text" autocomplete="off" placeholder=""></input>
              <div class="subText">
                (location of files to download)
              </div>
            </div>
          </div>
          <div class="intakeFormSection Form1 Form2 Form4 Form5">
            <div class="formSectionTitle">Attachments</div>
            <div class="formSectionInput">
              <input id="attachmentInput" class="formInput" data-property="Attachments" type="file" placeholder=""></input>
              <img src="https://microsoft.sharepoint.com/teams/Infopedia_Team_Site/Projects%20Folder/Trey%20Test%20Stuff/loading.gif" class="loadingImg hidden"/>
            </div>
          </div>
          <div class="intakeFormSection Form1 Form2 Form3">
            <div class="formSectionTitle">File Name*</div>
            <div class="formSectionInput">
              <input id="fileNameInput" class="requiredInput formInput fillContentArea" data-property="FileName" type="text" autocomplete="off" placeholder=""></input>
            </div>
          </div>
          <div class="intakeFormSection Form1 Form2">
            <div class="formSectionTitle">Document Title to Display*</div>
            <div class="formSectionInput">
              <input id="documentTitleInput" class="requiredInput formInput fillContentArea" data-property="DocumentTitle" type="text" autocomplete="off" placeholder=""></input>
            </div>
          </div>
          <div class="intakeFormSection Form1 Form2">
            <div class="formSectionTitle">Document Description</div>
            <div class="formSectionInput">
              <textarea id="documentDescriptionInput" class="optionalInput formInput fillContentArea" data-property="DocumentDescription" placeholder="" rows="4" cols="50"></textarea>
              <div class="subText">
                Needs to be short and useful for the field. Use key search terms where possible and include enough context so the item makes sense when returned individually in all-Microsoft search results. 225 chars or less.
              </div>
            </div>
          </div>
          <div class="intakeFormSection Form1 Form2">
            <div class="formSectionTitle">Maximum Reach (confidentiality)*</div>
            <div class="formSectionInput">
              <select id="maximumReachInput" class="requiredInput formInput" data-property="MaximumReach">
                <option disabled selected value> -- select an option -- </option>
                <option value="Internal Users (Default - MS Confidental)">Internal Users (Default - MS Confidental)</option>
                <option value="Customer Ready">Customer Ready</option>
                <option value="Partner Ready">Partner Ready</option>
                <option value="Non-Disclosure">Non-Disclosure</option>
              </select>
            </div>
          </div>
          <div class="intakeFormSection Form1 Form2 Form4">
              <div class="formSectionTitle">Content Owner* <div>Must be FTE</div></div>
              <div class="formSectionInput">
                <div class="subText" style="float:left; width:315px;">
                  Owner Alias*
                </div>
                <div class="subText" style="float:left; width:320px;">
                  Co-Owner Alias (Optional)
                </div>
                <input id="ownerInput" class=" requiredInput formInput" data-property="Owner" type="text" autocomplete="off"></input>
                <input id="coownerInput" class="optionalInput formInput" data-property="CoOwner" type="text" autocomplete="off"></input>
              </div>
          </div>
          <div class="intakeFormSection Form1">
            <div class="formSectionTitle">Page URL</div>
            <div class="formSectionInput">
              <input id="pageUrlInput" class="optionalInput formInput fillContentArea" data-property="PageURL" type="text" autocomplete="off"  placeholder="On which page(s) and card(s) does this asset belong (URLs)?"></input>
              <div class="subText">
                On which page(s) and card(s) does this asset belong (URLs)?
              </div>
            </div>
          </div>
          <div class="intakeFormSection Form1 Form2 Form4">
            <div class="formSectionTitle">Requested Publish Date</div>
            <div class="formSectionInput">
              <input type="date" id="publishDateInput" class="optionalInput formInput" data-property="PublishDate" value="" min="2018-01-01" max="2018-12-31" />
              <div class="subText">
                Note: that there’s a 3-business day SLA for publishing. We always aim for earlier completion but for a specific date (for example a planned comm or embargoed content)
                please share that requirement with the WindowsReady Submission alias in advance to accommodate pre-existing deliverables. More advanced notice is always better for us
                to create a workback plan with you.
              </div>
            </div>
          </div>
          <div class="intakeFormSection Form1 Form2 Form3">
            <div class="formSectionTitle">Additional Details</div>
            <div class="formSectionInput">
              <textarea id="additionalDetailsInput" class="optionalInput formInput fillContentArea" data-property="AdditionalDetails" placeholder="" rows="4" cols="50"></textarea>
            </div>
          </div>
          <div id="buttonContainer" class="">
            <div id="addBtn" class="inputBtn">Submit This Request</div>
          <!--  <div id="displayBtn" class="inputBtn">Display list items</div>
            <div id="listItemContainer">-->
              <ul>
              </ul>
            </div>
          </div>
          </div>
        </div>
      </div>
    </body>
</html>
